# JSP 홈페이지 만들기 -4

**작성일**: Wed, 15 Oct 2025 17:34:45 +0900

**원문 링크**: https://junsseok.tistory.com/30

---

<p style="text-align: center;">상세 페이지 첨부파일 수정, 댓글 기능, 회원가입 ID중복확인/PW 일치 기능 구현</p>
<hr contenteditable="false" />
<h3 style="text-align: center;">상세 페이지 첨부파일 수정</h3>
<p><figure class="imageblock alignCenter"><span><img height="797" src="https://blog.kakaocdn.net/dn/Vgi7K/btsQ8H303yn/mIfehLoQHYsUvGkkhtEyG1/img.png" width="387" /></span></figure>
<figure class="imageblock alignCenter"><span><img height="267" src="https://blog.kakaocdn.net/dn/HbbUA/btsRcEw9Foy/dKHGOWKuFQ7eb6hvO45z60/img.png" width="397" /></span></figure>
</p>
<p>첨부파일 수정된 것 확인 가능</p>
<p>&nbsp;</p>
<p>(Controller -&gt; Service -&gt; Dao로 동작)</p>
<p>&nbsp;</p>
<p>[Controller]</p>
<p>- 기존 파일이 있는지 확인</p>
<pre class="bash" id="code_1760515341124"><code>if (at != null) { // 업로드한 파일이 있다면
    if (originFileNo != null) { // 기존 첨부파일이 존재
        at.setFileNo(originFileNo);
    } else { // 기존첨부파일이 없을 때
        at.setRefBoardNo(b.getBoardNo());
    }
}

int result = new BoardService().updateBoard(b, at);</code></pre>
<p style="color: #333333; text-align: start;">-&gt; 기존 파일이 있는지 없는지 여부 확인 후 서비스로 넘어감</p>
<p>&nbsp;</p>
<p>[Service]</p>
<p>- 파일 존재시 파일교체, 파일 미존재시 신규 파일 등록</p>
<pre class="bash" id="code_1760515637020"><code> if (at != null) {
        if (at.getFileNo() != 0) { // 기존 파일 존재 &rarr; 파일 교체
            result *= dao.updateAttachment(conn, at);
        } else { // 신규 첨부파일 등록
            result *= dao.insertNewAttachment(conn, at);
        }
    }

    if (result &gt; 0) commit(conn);
    else rollback(conn);

    close(conn);
    return result;</code></pre>
<p>&nbsp;</p>
<p>[Dao]</p>
<p>- 파일 새로 업데이트</p>
<pre class="bash" id="code_1760515702596"><code>public int updateAttachment(Connection conn, Attachment at) {
    PreparedStatement pstmt = null;
    int result = 0;
    String sql = prop.getProperty("updateAttachment");

    try {
        pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, at.getOriginName());
        pstmt.setString(2, at.getChangeName());
        pstmt.setString(3, at.getFilePath());
        pstmt.setInt(4, at.getFileNo());
        result = pstmt.executeUpdate();
    } finally {
        close(pstmt);
    }
    return result;
}</code></pre>
<p>&nbsp;</p>
<p>- 파일 신규 등록</p>
<pre class="bash" id="code_1760515717363"><code>public int insertNewAttachment(Connection conn, Attachment at) {
    PreparedStatement pstmt = null;
    int result = 0;
    String sql = prop.getProperty("insertNewAttachment");

    try {
        pstmt = conn.prepareStatement(sql);
        pstmt.setInt(1, at.getRefBoardNo());
        pstmt.setString(2, at.getOriginName());
        pstmt.setString(3, at.getChangeName());
        pstmt.setString(4, at.getFilePath());
        result = pstmt.executeUpdate();
    } finally {
        close(pstmt);
    }
    return result;
}</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>[XML]</p>
<p>- 업데이트 쿼리</p>
<pre class="bash" id="code_1760515766724"><code>&lt;entry key="updateAttachment"&gt;
	UPDATE ATTACHMENT
		SET ORIGIN_NAME = ?,
		CHANGE_NAME = ?,
		FILE_PATH = ?
	WHERE FILE_NO = ?
&lt;/entry&gt;</code></pre>
<p>- 신규 등록 쿼리</p>
<pre class="bash" id="code_1760515795899"><code>&lt;entry key="insertNewAttachment"&gt;
	INSERT
	INTO ATTACHMENT(
		FILE_NO,
		REF_BNO,
		ORIGIN_NAME,
		CHANGE_NAME,
		FILE_PATH
	) VALUES(
		SEQ_FNO.NEXTVAL,
		?,
		?,
		?,
		?
	)
&lt;/entry&gt;</code></pre>
<hr contenteditable="false" />
<h3 style="text-align: center;">댓글 기능</h3>
<p><figure class="imageblock alignCenter"><span><img height="387" src="https://blog.kakaocdn.net/dn/ASORM/btsRaGXq3dX/Y4vj2i1UsV2ercv8aKCjk1/img.png" width="437" /></span></figure>
<figure class="imageblock alignCenter"><span><img height="409" src="https://blog.kakaocdn.net/dn/Gi8jT/btsRceerCGR/DwT8EP7RljI2KPFCCKnoO0/img.png" width="442" /></span></figure>
</p>
<p>댓글 작성 확인 가능</p>
<p>&nbsp;</p>
<p style="color: #333333; text-align: start;">(Controller -&gt; Service -&gt; Dao로 동작)</p>
<p style="color: #333333; text-align: start;">&nbsp;</p>
<p style="color: #333333; text-align: start;">[Controller]</p>
<p style="color: #333333; text-align: start;">- 사용자가 게시글에 댓글을 작성하고 '등록'버튼을 누르면 AJAX 요청이 /rinsert.bo 서블릿으로 전송</p>
<pre class="bash" id="code_1760516238635"><code>@WebServlet("/rinsert.bo")
public class AjaxReplyInsertController extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        int boardNo = Integer.parseInt(request.getParameter("boardNo"));
        String replyContent = request.getParameter("content");
        int memberNo = ((Member) request.getSession()
                           .getAttribute("loginMember")).getMemberNo();

        Reply r = new Reply();
        r.setRefBoardNo(boardNo);
        r.setReplyContent(replyContent);
        r.setReplyWriter(memberNo);

        int result = new BoardService().insertReply(r);

        response.getWriter().print(result);
    }
}</code></pre>
<p>-&gt; 요청 파라미터를 받아 boardNo와 content를 추출 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> 세션에서&nbsp;로그인한&nbsp;사용자의&nbsp;memberNo를&nbsp;가져옴 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> 이&nbsp;정보로&nbsp;Reply&nbsp;객체를&nbsp;만들어&nbsp;댓글&nbsp;데이터를&nbsp;준비 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> 준비된&nbsp;Reply&nbsp;객체를&nbsp;BoardService.insertReply()&nbsp;메서드로&nbsp;전달 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> 서비스가&nbsp;반환한&nbsp;결과(성공:&nbsp;1,&nbsp;실패:&nbsp;0)를&nbsp;그대로&nbsp;AJAX에&nbsp;반환</p>
<p>&nbsp;</p>
<p>[Service]</p>
<pre class="bash" id="code_1760516374387"><code>public int insertReply(Reply r) {
    Connection conn = getConnection();

    int result = new BoardDao().insertReply(conn, r);

    if (result &gt; 0) {
        commit(conn);
    } else {
        rollback(conn);
    }

    close(conn);
    return result;
}</code></pre>
<p><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> DB&nbsp;커넥션을&nbsp;부름 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> DAO의&nbsp;insertReply()를&nbsp;호출하여&nbsp;실제&nbsp;DB에&nbsp;댓글을&nbsp;저장 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> DAO&nbsp;결과가&nbsp;성공이면&nbsp;commit,&nbsp;실패면&nbsp;rollback&nbsp;처리 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span> 커넥션을&nbsp;닫고&nbsp;결과값을&nbsp;Controller에&nbsp;반환</p>
<p>&nbsp;</p>
<p>[Dao]</p>
<pre class="bash" id="code_1760516396499"><code>public int insertReply(Connection conn, Reply r) {
    int result = 0;
    PreparedStatement pstmt = null;
    String sql = prop.getProperty("insertReply");

    try {
        pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, r.getReplyContent());
        pstmt.setInt(2, r.getRefBoardNo());
        pstmt.setInt(3, r.getReplyWriter());

        result = pstmt.executeUpdate();
    } catch (SQLException e) {
        e.printStackTrace();
    } finally {
        close(pstmt);
    }

    return result;
}</code></pre>
<p><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span><span style="color: #333333; text-align: start;"><span>&nbsp;</span></span> SQL&nbsp;쿼리를&nbsp;실행하여&nbsp;댓글을&nbsp;DB에&nbsp;삽입 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span><span style="color: #333333; text-align: start;"><span>&nbsp;</span></span> PreparedStatement를&nbsp;사용해&nbsp;댓글&nbsp;내용,&nbsp;게시글&nbsp;번호,&nbsp;작성자&nbsp;번호를&nbsp;바인딩 <br /><span style="color: #333333; text-align: start;">-&gt;<span>&nbsp;</span></span><span style="color: #333333; text-align: start;"><span>&nbsp;</span></span> executeUpdate()가&nbsp;성공하면&nbsp;1,&nbsp;실패하면&nbsp;0을&nbsp;반환</p>
<p>&nbsp;</p>
<p>[XML]</p>
<p>- 쿼리문을 사용하여 데베에 댓글 저장</p>
<pre class="bash" id="code_1760516451170"><code>&lt;entry key="insertReply"&gt;
	INSERT
	INTO REPLY(
		REPLY_NO,
		REPLY_CONTENT,
		REF_BNO,
		REPLY_WRITER
	) VALUES(
		SEQ_RNO.NEXTVAL,
		?,
		?,
		?
	)
&lt;/entry&gt;</code></pre>
<hr contenteditable="false" />
<h3 style="text-align: center;">ID 중복체크</h3>
<p><figure class="imageblock alignCenter"><span><img height="476" src="https://blog.kakaocdn.net/dn/rVBt1/btsRbGPVISQ/uzKcz5n5VJ1kBi3JzBaDZ1/img.png" width="409" /></span></figure>
</p>
<p>&nbsp;</p>
<p><figure class="imageblock alignCenter"><span><img height="599" src="https://blog.kakaocdn.net/dn/bMuI01/btsRbv8RYao/VKrXX1zbJtop4pPr4uOkb0/img.png" width="417" /></span></figure>
</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>아이디가 데베에 존재시 존재하는 ID입니다 출력, 존재하지 않을시 사용 가능 아이디라고 안내</p>
<p>&nbsp;</p>
<p>[Controller]</p>
<p>- Ajax 요청으로 전달된 아이디가 DB에 존재하는지 확인 후 결과를 반환</p>
<pre class="bash" id="code_1760516833058"><code>@WebServlet("/idDulpicateCheck.me")
public class AjaxIdCheckController extends HttpServlet {
    private static final long serialVersionUID = 1L;

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        // 1. 클라이언트가 보낸 체크할 ID 받아오기
        String checkId = request.getParameter("checkId");
        
        // 2. 서비스 호출 -&gt; DB에서 아이디 존재 여부 확인
        int count = new MemberService().idCheck(checkId);
        
        // 3. 결과 반환
        if (count &gt; 0) {
            response.getWriter().print("NNNNN"); // 존재
        } else {
            response.getWriter().print("NNNNY"); // 존재하지 않음
        }
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        doGet(request, response);
    }
}</code></pre>
<p>&nbsp;</p>
<p>[Service]</p>
<p>-&gt; DAO 호출 후 커넥션 관리</p>
<pre class="bash" id="code_1760516953977"><code>public int idCheck(String checkId) {
    Connection conn = getConnection();
    
    int count = new MemberDao().idCheck(conn, checkId);
    
    close(conn);
    return count;
}</code></pre>
<p>&nbsp;</p>
<p>[Dao]</p>
<pre class="bash" id="code_1760516878202"><code>// 아이디 중복 체크
public int idCheck(Connection conn, String checkId) {
    int count = 0;
    PreparedStatement pstmt = null;
    ResultSet rset = null;
    
    String sql = prop.getProperty("idCheck"); // SQL: SELECT COUNT(*) AS COUNT FROM MEMBER WHERE MEMBER_ID = ?
    
    try {
        pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, checkId);
        rset = pstmt.executeQuery();
        
        if (rset.next()) {
            count = rset.getInt("COUNT");
        }
    } catch (SQLException e) {
        e.printStackTrace();
    } finally {
        close(rset);
        close(pstmt);
    }
    
    return count;
}</code></pre>
<p>-&gt;&nbsp;DB에서&nbsp;같은&nbsp;아이디를&nbsp;가진&nbsp;회원&nbsp;수를&nbsp;조회 <br />-&gt; 반환값: 0 : 존재하지 않음, 1 이상 : 이미 존재</p>
<p>&nbsp;</p>
<p>[JSP의 JS코드]</p>
<pre class="bash" id="code_1760517159025"><code>function idDulpicateCheck(){
    const idInput = document.querySelector("#enroll-form input[name=userId]");

    if(idInput.value.length &lt; 5) { //아이디 형식 예외 처리
        return;
    }

    $.ajax({
        url : "idDulpicateCheck.me",
        type : "get",
        data : { checkId : idInput.value },
        success: function(result){
            if(result === "NNNNN") { // 이미 존재
                alert("이미 존재하는 ID입니다.");
                idInput.focus();
            } else { // 사용 가능
                if(confirm("사용가능한 아이디입니다. 사용하시겠습니까?")){
                    idInput.setAttribute("readonly", true); // 더이상 변경 불가

                    // 제출 버튼 활성화
                    const submitBtn = document.querySelector("#enroll-form button[type=submit]");
                    submitBtn.removeAttribute("disabled");
                } else{
                    idInput.focus();
                }
            }
        }, 
        error: function(err){
            console.log("아이디 체크 요청 실패 : ", err);
        }
    })
}</code></pre>
<p>-&gt;&nbsp;사용자가&nbsp;입력한&nbsp;ID를&nbsp;추출 <br />-&gt;&nbsp;길이가&nbsp;5&nbsp;미만이면&nbsp;체크하지&nbsp;않고&nbsp;바로&nbsp;종료 <br />-&gt;&nbsp;Ajax&nbsp;요청을&nbsp;통해&nbsp;서버의&nbsp;AjaxIdCheckController&nbsp;호출 <br />-&gt;&nbsp;서버&nbsp;응답이&nbsp;"NNNNN"&nbsp;-&gt;&nbsp;이미&nbsp;존재&nbsp;-&gt;&nbsp;alert <br />-&gt;&nbsp;"NNNNY"&nbsp;-&gt;&nbsp;사용&nbsp;가능&nbsp;-&gt;&nbsp;confirm으로&nbsp;사용&nbsp;여부&nbsp;결정 <br />-&gt;&nbsp;사용&nbsp;시,&nbsp;input&nbsp;readonly&nbsp;처리&nbsp;+&nbsp;submit&nbsp;버튼&nbsp;활성화</p>
<hr contenteditable="false" />
<h3 style="text-align: center;">비밀번호 일치 체크</h3>
<p><figure class="imageblock alignCenter"><span><img height="557" src="https://blog.kakaocdn.net/dn/XBlfh/btsRbv16Qji/3eg4IXIoHmqCfVRlDJ8MzK/img.png" width="411" /></span></figure>
</p>
<p>&nbsp;</p>
<p>!!프론트에서 처리</p>
<p>[JSP의 JS코드]</p>
<pre class="bash" id="code_1760517069913"><code>function validationCheck(){
    const pwdInputList = document.querySelectorAll("#enroll-form input[type=password]");
    
    if(pwdInputList[0].value !== pwdInputList[1].value){
        alert("비밀번호가 일치하지 않습니다.");
        return false;
    }
}</code></pre>
<p>-&gt;&nbsp;enroll-form&nbsp;안의&nbsp;input[type=password]&nbsp;요소를&nbsp;모두&nbsp;추출 <br />-&gt;&nbsp;pwdInputList[0]&nbsp;-&gt;&nbsp;비밀번호 <br />-&gt;&nbsp;pwdInputList[1]&nbsp;-&gt;&nbsp;비밀번호&nbsp;확인 <br />-&gt;&nbsp;두&nbsp;값이&nbsp;같지&nbsp;않으면&nbsp;alert&nbsp;출력&nbsp;후&nbsp;폼&nbsp;제출&nbsp;막음 <br />-&gt;&nbsp;일치시&nbsp;아무&nbsp;동작&nbsp;없이&nbsp;폼&nbsp;제출</p>
<p>&nbsp;</p>
<hr contenteditable="false" />
<p style="text-align: center;">이후 댓글 삭제 사진게시판 구현 예정!!</p>
<hr contenteditable="false" />
<p style="text-align: center;">깃허브 주소 : <a href="https://github.com/20200961/JSP_Board_Project">https://github.com/20200961/JSP_Board_Project</a></p>